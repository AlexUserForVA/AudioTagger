
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>server package &#8212; Audio Tagger 1.0 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="server.config package" href="server.config.html" />
    <link rel="prev" title="server" href="modules.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="server.config.html" title="server.config package"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="modules.html" title="server"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Audio Tagger 1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="modules.html" accesskey="U">server</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="server-package">
<h1>server package<a class="headerlink" href="#server-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="server.config.html">server.config package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="server.config.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="server.config.html#module-server.config.config">server.config.config module</a></li>
<li class="toctree-l2"><a class="reference internal" href="server.config.html#module-server.config.load_config">server.config.load_config module</a></li>
<li class="toctree-l2"><a class="reference internal" href="server.config.html#module-server.config">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="server.consumer.html">server.consumer package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="server.consumer.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="server.consumer.predictors.html">server.consumer.predictors package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="server.consumer.predictors.html#subpackages">Subpackages</a><ul>
<li class="toctree-l5"><a class="reference internal" href="server.consumer.predictors.dcase_predictor_provider.html">server.consumer.predictors.dcase_predictor_provider package</a><ul>
<li class="toctree-l6"><a class="reference internal" href="server.consumer.predictors.dcase_predictor_provider.html#submodules">Submodules</a></li>
<li class="toctree-l6"><a class="reference internal" href="server.consumer.predictors.dcase_predictor_provider.html#module-server.consumer.predictors.dcase_predictor_provider.baseline_net">server.consumer.predictors.dcase_predictor_provider.baseline_net module</a><ul class="simple">
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="server.consumer.predictors.dcase_predictor_provider.html#module-server.consumer.predictors.dcase_predictor_provider.dcase_predictor_provider">server.consumer.predictors.dcase_predictor_provider.dcase_predictor_provider module</a></li>
<li class="toctree-l6"><a class="reference internal" href="server.consumer.predictors.dcase_predictor_provider.html#module-server.consumer.predictors.dcase_predictor_provider">Module contents</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="server.consumer.predictors.example_predictor.html">server.consumer.predictors.example_predictor package</a><ul>
<li class="toctree-l6"><a class="reference internal" href="server.consumer.predictors.example_predictor.html#submodules">Submodules</a></li>
<li class="toctree-l6"><a class="reference internal" href="server.consumer.predictors.example_predictor.html#module-server.consumer.predictors.example_predictor.dummy_predictor">server.consumer.predictors.example_predictor.dummy_predictor module</a></li>
<li class="toctree-l6"><a class="reference internal" href="server.consumer.predictors.example_predictor.html#module-server.consumer.predictors.example_predictor">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="server.consumer.predictors.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="server.consumer.predictors.html#module-server.consumer.predictors.predictor_contract">server.consumer.predictors.predictor_contract module</a></li>
<li class="toctree-l4"><a class="reference internal" href="server.consumer.predictors.html#module-server.consumer.predictors">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="server.consumer.visualizers.html">server.consumer.visualizers package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="server.consumer.visualizers.html#subpackages">Subpackages</a><ul>
<li class="toctree-l5"><a class="reference internal" href="server.consumer.visualizers.spectrogram.html">server.consumer.visualizers.spectrogram package</a><ul>
<li class="toctree-l6"><a class="reference internal" href="server.consumer.visualizers.spectrogram.html#submodules">Submodules</a></li>
<li class="toctree-l6"><a class="reference internal" href="server.consumer.visualizers.spectrogram.html#module-server.consumer.visualizers.spectrogram.madmom_spectrogram_provider">server.consumer.visualizers.spectrogram.madmom_spectrogram_provider module</a></li>
<li class="toctree-l6"><a class="reference internal" href="server.consumer.visualizers.spectrogram.html#module-server.consumer.visualizers.spectrogram">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="server.consumer.visualizers.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="server.consumer.visualizers.html#module-server.consumer.visualizers.visualisation_contract">server.consumer.visualizers.visualisation_contract module</a></li>
<li class="toctree-l4"><a class="reference internal" href="server.consumer.visualizers.html#module-server.consumer.visualizers">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="server.consumer.html#module-server.consumer">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-server.audio_tagger_manager">
<span id="server-audio-tagger-manager-module"></span><h2>server.audio_tagger_manager module<a class="headerlink" href="#module-server.audio_tagger_manager" title="Permalink to this headline">¶</a></h2>
<p>Audio Tagger’s main module which manages audio producers and all consumers.</p>
<p>In this central module of the backend system, we define major components
like a shared memory implemented as a ring buffer which holds audio chunks
coming from the producers (MicrophoneThread and AudiofileThread). Respectively,
all the chunks are consumed by modules which e.g. compute spectrogram
representation or make predictions based on a trained model for an
audio input chunk.
Once there are multiple consumers, synchronization needs to be considered.
To ensure that consumers do not drift off too far, the audio tagger manager
keeps track of a global timing variable <code class="docutils literal notranslate"><span class="pre">tGroundTruth</span></code>. It is increased
every time a producer delivers a new audio chunk. When a consumer is ready
to process new chunks, it asks for <code class="docutils literal notranslate"><span class="pre">tGroundTruth</span></code>’s timestamp and reads
chunks from shared memory related to this timestamp.</p>
<dl class="class">
<dt id="server.audio_tagger_manager.AudioTaggerManager">
<em class="property">class </em><code class="descclassname">server.audio_tagger_manager.</code><code class="descname">AudioTaggerManager</code><span class="sig-paren">(</span><em>visualProvider</em>, <em>predProvider</em>, <em>predList</em>, <em>audiofileList</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/server/audio_tagger_manager.html#AudioTaggerManager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#server.audio_tagger_manager.AudioTaggerManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>This is the central management class of the audio tagger backend system.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>visualProvider</strong><span class="classifier">VisualisationContract</span></dt><dd><p>a consumer which processes audio chunks to visual representation</p>
</dd>
<dt><strong>predProvider</strong><span class="classifier">PredictorContract</span></dt><dd><p>a consumer which processes audio chunks to class predictions</p>
</dd>
<dt><strong>predList</strong><span class="classifier">list</span></dt><dd><p>list of available predictors</p>
</dd>
<dt><strong>audiofileList</strong><span class="classifier">list</span></dt><dd><p>list of available audio files</p>
</dd>
<dt><strong>curVisual</strong><span class="classifier">2d numpy array of float values</span></dt><dd><p>holds the current visual representation object</p>
</dd>
<dt><strong>curPred</strong><span class="classifier">numpy array of list objects</span></dt><dd><p>holds the current class prediction object</p>
</dd>
<dt><strong>sharedMemory</strong><span class="classifier">deque</span></dt><dd><p>shared memory object (ring buffer) holding audio chunks</p>
</dd>
<dt><strong>tGroundTruth: int</strong></dt><dd><p>global timing variable used for synchronization</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="docutils align-center">
<colgroup>
<col style="width: 27%" />
<col style="width: 73%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>getPredList()</strong></p></td>
<td><p>returns a list of available predictors.</p></td>
</tr>
<tr class="row-even"><td><p><strong>getAudiofileList()</strong></p></td>
<td><p>returns a list of available audio files.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>setPredProvider()</strong></p></td>
<td><p>set a new prediciton provider of type <code class="docutils literal notranslate"><span class="pre">PredictorContract</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><strong>getVisualisation()</strong></p></td>
<td><p>returns the most recent visualisation.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>getPrediction()</strong></p></td>
<td><p>returns the most recent class predictions.</p></td>
</tr>
<tr class="row-even"><td><p><strong>onNewVisualisationCalculated(image)</strong></p></td>
<td><p>called from visualisation consumers when new representation is computed.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>onNewPredictionCalculated(prob_dict)</strong></p></td>
<td><p>called from predictor consumers when new class predictions are computed.</p></td>
</tr>
<tr class="row-even"><td><p><strong>startThreads()</strong></p></td>
<td><p>start producers and consumers when audio tagger manager has completed its initialization.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>refreshAudioTagger()</strong></p></td>
<td><p>method is called when frontend informs backend about changed settings regarding predictors and audio input.</p></td>
</tr>
<tr class="row-even"><td><p><strong>putToSM()</strong></p></td>
<td><p>adds a new audio chunk to the shared memory.</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="server.audio_tagger_manager.AudioTaggerManager.getAudiofileList">
<code class="descname">getAudiofileList</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/server/audio_tagger_manager.html#AudioTaggerManager.getAudiofileList"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#server.audio_tagger_manager.AudioTaggerManager.getAudiofileList" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the list of audio files</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>list</strong></dt><dd><p>a list of available audio files</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="server.audio_tagger_manager.AudioTaggerManager.getPredList">
<code class="descname">getPredList</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/server/audio_tagger_manager.html#AudioTaggerManager.getPredList"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#server.audio_tagger_manager.AudioTaggerManager.getPredList" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the list of predictors</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>list</strong></dt><dd><p>a list of available predictors</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="server.audio_tagger_manager.AudioTaggerManager.getPrediction">
<code class="descname">getPrediction</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/server/audio_tagger_manager.html#AudioTaggerManager.getPrediction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#server.audio_tagger_manager.AudioTaggerManager.getPrediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the newest class prediction processed
by backend.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>curPred</strong><span class="classifier">numpy array of list objects</span></dt><dd><p>returns a copy of the current class prediction object</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="server.audio_tagger_manager.AudioTaggerManager.getVisualisation">
<code class="descname">getVisualisation</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/server/audio_tagger_manager.html#AudioTaggerManager.getVisualisation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#server.audio_tagger_manager.AudioTaggerManager.getVisualisation" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the newest visual representation processed
by backend.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>curVisual</strong><span class="classifier">2d numpy array of float values</span></dt><dd><p>returns a copy of the current visual representation object</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="server.audio_tagger_manager.AudioTaggerManager.onNewPredictionCalculated">
<code class="descname">onNewPredictionCalculated</code><span class="sig-paren">(</span><em>prob_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/server/audio_tagger_manager.html#AudioTaggerManager.onNewPredictionCalculated"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#server.audio_tagger_manager.AudioTaggerManager.onNewPredictionCalculated" title="Permalink to this definition">¶</a></dt>
<dd><p>Is called every time a predictor consumer
has processed a new class prediction item.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>prob_dict</strong><span class="classifier">numpy array of list objects</span></dt><dd><p>holds the current class prediction object</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="server.audio_tagger_manager.AudioTaggerManager.onNewVisualisationCalculated">
<code class="descname">onNewVisualisationCalculated</code><span class="sig-paren">(</span><em>image</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/server/audio_tagger_manager.html#AudioTaggerManager.onNewVisualisationCalculated"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#server.audio_tagger_manager.AudioTaggerManager.onNewVisualisationCalculated" title="Permalink to this definition">¶</a></dt>
<dd><p>Is called every time a visualisation consumer
has processed a new visual representation item.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>image</strong><span class="classifier">2d numpy array of float values</span></dt><dd><p>holds the current visual representation object</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="server.audio_tagger_manager.AudioTaggerManager.putToSM">
<code class="descname">putToSM</code><span class="sig-paren">(</span><em>chunk</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/server/audio_tagger_manager.html#AudioTaggerManager.putToSM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#server.audio_tagger_manager.AudioTaggerManager.putToSM" title="Permalink to this definition">¶</a></dt>
<dd><p>adds a new audio chunk to the shared memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>chunk</strong><span class="classifier">bytes</span></dt><dd><p>an array of audio sample values encoded as byte string</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="server.audio_tagger_manager.AudioTaggerManager.refreshAudioTagger">
<code class="descname">refreshAudioTagger</code><span class="sig-paren">(</span><em>settings</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/server/audio_tagger_manager.html#AudioTaggerManager.refreshAudioTagger"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#server.audio_tagger_manager.AudioTaggerManager.refreshAudioTagger" title="Permalink to this definition">¶</a></dt>
<dd><p>method is called when frontend informs backend about changed
settings regarding predictors and audio input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>settings</strong><span class="classifier">dictionary</span></dt><dd><p>a dictionary holding the a flag for microphone/audio file input
and IDs for the desired predictor and audio file, respectively.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="server.audio_tagger_manager.AudioTaggerManager.setPredProvider">
<code class="descname">setPredProvider</code><span class="sig-paren">(</span><em>predProvider</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/server/audio_tagger_manager.html#AudioTaggerManager.setPredProvider"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#server.audio_tagger_manager.AudioTaggerManager.setPredProvider" title="Permalink to this definition">¶</a></dt>
<dd><p>set the reference of the currently active predictor object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>predProvider</strong><span class="classifier">PredictorContract</span></dt><dd><p>consumer which processes class predictions</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="server.audio_tagger_manager.AudioTaggerManager.startThreads">
<code class="descname">startThreads</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/server/audio_tagger_manager.html#AudioTaggerManager.startThreads"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#server.audio_tagger_manager.AudioTaggerManager.startThreads" title="Permalink to this definition">¶</a></dt>
<dd><p>start producers and consumers when audio tagger manager has
completed its initialization.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="server.audio_tagger_manager.AudiofileThread">
<em class="property">class </em><code class="descclassname">server.audio_tagger_manager.</code><code class="descname">AudiofileThread</code><span class="sig-paren">(</span><em>manager</em>, <em>filePath</em>, <em>name='AudiofileThread'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/server/audio_tagger_manager.html#AudiofileThread"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#server.audio_tagger_manager.AudiofileThread" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/threading.html#threading.Thread" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">threading.Thread</span></code></a></p>
<p>Thread for audio input over files.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>manager</strong><span class="classifier">audio tagger manager object</span></dt><dd><p>reference to the audio tagger manager</p>
</dd>
<dt><strong>p</strong><span class="classifier">PyAudio object</span></dt><dd><p>an object to read audio input and process
it to get digital chunks of samples</p>
</dd>
<dt><strong>wf</strong><span class="classifier">wave object</span></dt><dd><p>opens a wave object which reads a audio file
with path <code class="docutils literal notranslate"><span class="pre">filePath</span></code></p>
</dd>
<dt><strong>stream</strong><span class="classifier">PyAudio stream object</span></dt><dd><p>stream of the pyaudio object</p>
</dd>
<dt><strong>_stopevent</strong><span class="classifier">threading.Event</span></dt><dd><p>indicator for stopping a thread loop</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="docutils align-center">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>run()</strong></p></td>
<td><p>method triggered when start() method is called.</p></td>
</tr>
<tr class="row-even"><td><p><strong>join()</strong></p></td>
<td><p>sends stop signal to thread.</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="server.audio_tagger_manager.AudiofileThread.join">
<code class="descname">join</code><span class="sig-paren">(</span><em>timeout=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/server/audio_tagger_manager.html#AudiofileThread.join"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#server.audio_tagger_manager.AudiofileThread.join" title="Permalink to this definition">¶</a></dt>
<dd><p>Stops the thread.</p>
<p>This method tries to stop a thread. When timeout has passed
and the thread could not be stopped yet, the program continues.
If timeout is set to None, join blocks until the thread is stopped.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>timeout</strong><span class="classifier">float</span></dt><dd><p>a timeout value in seconds</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="server.audio_tagger_manager.AudiofileThread.run">
<code class="descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/server/audio_tagger_manager.html#AudiofileThread.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#server.audio_tagger_manager.AudiofileThread.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads sampled audio chunks coming from an audio file and
puts them into the shared memory. Finally, the global time variable
<code class="docutils literal notranslate"><span class="pre">tGroundTruth</span></code> is incremented by 1.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="server.audio_tagger_manager.MicrophoneThread">
<em class="property">class </em><code class="descclassname">server.audio_tagger_manager.</code><code class="descname">MicrophoneThread</code><span class="sig-paren">(</span><em>manager</em>, <em>name='MicrophoneThread'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/server/audio_tagger_manager.html#MicrophoneThread"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#server.audio_tagger_manager.MicrophoneThread" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/threading.html#threading.Thread" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">threading.Thread</span></code></a></p>
<p>Thread for audio input over microphone.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>manager</strong><span class="classifier">audio tagger manager object</span></dt><dd><p>reference to the audio tagger manager</p>
</dd>
<dt><strong>p</strong><span class="classifier">PyAudio object</span></dt><dd><p>an object to read audio input and process
it to get digital chunks of samples.</p>
</dd>
<dt><strong>stream</strong><span class="classifier">PyAudio stream object</span></dt><dd><p>stream of the pyaudio object</p>
</dd>
<dt><strong>_stopevent</strong><span class="classifier">threading.Event</span></dt><dd><p>indicator for stopping a thread loop</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="docutils align-center">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>run()</strong></p></td>
<td><p>method triggered when start() method is called.</p></td>
</tr>
<tr class="row-even"><td><p><strong>join()</strong></p></td>
<td><p>sends stop signal to thread.</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="server.audio_tagger_manager.MicrophoneThread.join">
<code class="descname">join</code><span class="sig-paren">(</span><em>timeout=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/server/audio_tagger_manager.html#MicrophoneThread.join"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#server.audio_tagger_manager.MicrophoneThread.join" title="Permalink to this definition">¶</a></dt>
<dd><p>Stops the thread.</p>
<p>This method tries to stop a thread. When timeout has passed
and the thread could not be stopped yet, the program continues.
If timeout is set to None, join blocks until the thread is stopped.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>timeout</strong><span class="classifier">float</span></dt><dd><p>a timeout value in seconds</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="server.audio_tagger_manager.MicrophoneThread.run">
<code class="descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/server/audio_tagger_manager.html#MicrophoneThread.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#server.audio_tagger_manager.MicrophoneThread.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads sampled audio chunks coming from a microphone and
puts them into the shared memory. Finally, the global time variable
<code class="docutils literal notranslate"><span class="pre">tGroundTruth</span></code> is incremented by 1.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-server.webserver">
<span id="server-webserver-module"></span><h2>server.webserver module<a class="headerlink" href="#module-server.webserver" title="Permalink to this headline">¶</a></h2>
<p>This is the python script for starting up the backend providing the necessary
REST API interface methods to access the audio input visualisations and predictions
periodically computed by the backend.</p>
<p>At first, available audio files and predictors are loaded and the backend is
initialized. The starting visualisation component is still fixed in this version.
The starting predictor can be configured in the config.py module by setting the
id of the predictor listed in predictors.csv. After initialization, the module
opens an application server providing various REST interface methods. The host
is fixed at <a class="reference external" href="http://127.0.0.1:5000">http://127.0.0.1:5000</a>.
Possible GET requests are audio input visualisation (e.g. spectrogram) and the class predictions
of a certain model based on the current audio input. Beyond reading data from the
web server, one can also send the backend that it should switch to another
predictor or should use microphone input or audio file input.</p>
<dl class="function">
<dt id="server.webserver.audiofile_list">
<code class="descclassname">server.webserver.</code><code class="descname">audiofile_list</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/server/webserver.html#audiofile_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#server.webserver.audiofile_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Http GET interface method to receive a list of available audio files.
(URI: /audiofile_list)</p>
<p>This method returns a list of audio files which can be selected
and subsequently processed by the backend system. Each audio file
comes with it’s ID and a displayname.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>Response</strong><span class="classifier">json</span></dt><dd><p>a json object with the available audio files in the following form:
<code class="docutils literal notranslate"><span class="pre">[{&quot;id&quot;:</span> <span class="pre">0,</span> <span class="pre">&quot;displayname&quot;:</span> <span class="pre">&quot;Trumpets&quot;},</span> <span class="pre">{&quot;id&quot;:</span> <span class="pre">1,</span> <span class="pre">&quot;displayname&quot;:</span> <span class="pre">&quot;Song1&quot;},</span> <span class="pre">{&quot;id&quot;:</span> <span class="pre">2,</span> <span class="pre">&quot;displayname&quot;:</span> <span class="pre">&quot;Song2&quot;},</span> <span class="pre">...]</span></code></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="server.webserver.live_pred">
<code class="descclassname">server.webserver.</code><code class="descname">live_pred</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/server/webserver.html#live_pred"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#server.webserver.live_pred" title="Permalink to this definition">¶</a></dt>
<dd><p>Http GET interface method to request most current class predictions.
(URI: /live_pred)</p>
<p>Once the backend has computed new predictions based on current audio input
they can be accessed via this REST interface method.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>Response</strong><span class="classifier">json</span></dt><dd><p>a json object with the class predictions in the following form:
<code class="docutils literal notranslate"><span class="pre">[[&quot;Acoustic_guitar&quot;,</span> <span class="pre">0.0006955251446925104,</span> <span class="pre">0],</span> <span class="pre">[&quot;Applause&quot;,</span> <span class="pre">0.0032770668622106314,</span> <span class="pre">1],</span> <span class="pre">...]</span></code></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="server.webserver.live_visual">
<code class="descclassname">server.webserver.</code><code class="descname">live_visual</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/server/webserver.html#live_visual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#server.webserver.live_visual" title="Permalink to this definition">¶</a></dt>
<dd><p>Http GET interface method to request most current audio visualisation
(URI: /live_visual).</p>
<p>The backend periodically computes new visual representations of the
currently incoming audio chunks. This method provides access to
the most recent visual representation (e.g. spectrogram).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>Response</strong></dt><dd><p>a response object with the visualisation in jpeg-format as content.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="server.webserver.live_visual_browser">
<code class="descclassname">server.webserver.</code><code class="descname">live_visual_browser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/server/webserver.html#live_visual_browser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#server.webserver.live_visual_browser" title="Permalink to this definition">¶</a></dt>
<dd><p>Http GET interface method to request most current audio visualisation
(browser ready) (URI: /live_visual_browser).</p>
<p>This method is equivalent to live_visual() except that response content
is adapted to be visualized in the browser.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>Response</strong></dt><dd><p>a response object with the visualisation in jpeg-format as content
which can be displayed in browser.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="server.webserver.pred_list">
<code class="descclassname">server.webserver.</code><code class="descname">pred_list</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/server/webserver.html#pred_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#server.webserver.pred_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Http GET interface method to receive a list of available predictors.
(URI: /pred_list)</p>
<p>This method returns all predictors available in the backend system.
Each predictor comes with the following properties:</p>
<ul class="simple">
<li><p>ID</p></li>
<li><p>Displayname</p></li>
<li><p>Number of classes</p></li>
<li><p>Description</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>Response</strong><span class="classifier">json</span></dt><dd><p>a json object with the available predictors in the following form:
<code class="docutils literal notranslate"><span class="pre">[{&quot;id&quot;:</span> <span class="pre">0,</span> <span class="pre">&quot;displayname&quot;:</span> <span class="pre">&quot;DCASEPredictor&quot;,</span> <span class="pre">&quot;classes&quot;:</span> <span class="pre">&quot;41&quot;,</span> <span class="pre">&quot;description&quot;:</span> <span class="pre">&quot;sample</span> <span class="pre">description</span> <span class="pre">for</span> <span class="pre">dcase&quot;},</span>
<span class="pre">{&quot;id&quot;:</span> <span class="pre">1,</span> <span class="pre">&quot;displayname&quot;:</span> <span class="pre">&quot;SportsPredictor&quot;,</span> <span class="pre">&quot;classes&quot;:</span> <span class="pre">&quot;3&quot;,</span> <span class="pre">&quot;description&quot;:</span> <span class="pre">&quot;sample</span> <span class="pre">description</span> <span class="pre">for</span> <span class="pre">detecting</span> <span class="pre">sports&quot;},</span> <span class="pre">...]</span></code></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="server.webserver.send_new_settings">
<code class="descclassname">server.webserver.</code><code class="descname">send_new_settings</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/server/webserver.html#send_new_settings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#server.webserver.send_new_settings" title="Permalink to this definition">¶</a></dt>
<dd><p>Http POST interface method for sending new configuration settings
to backend system.
(URI: /settings)</p>
<p>This methods allows to change the currently active predictor and the
audio input source on the fly without stopping the backend. Once a user
selected audio file input, a list of audio files is available to select
a certain input source. The body of the POST message should look as follows:
<code class="docutils literal notranslate"><span class="pre">{'isLive':</span> <span class="pre">1,</span> <span class="pre">'file':</span> <span class="pre">0,</span> <span class="pre">'predictor':</span> <span class="pre">1}</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>Http Status Code</strong></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-server">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-server" title="Permalink to this headline">¶</a></h2>
<p>This package builds the backend system of
the audio tagger project.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">server package</a><ul>
<li><a class="reference internal" href="#subpackages">Subpackages</a></li>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-server.audio_tagger_manager">server.audio_tagger_manager module</a></li>
<li><a class="reference internal" href="#module-server.webserver">server.webserver module</a></li>
<li><a class="reference internal" href="#module-server">Module contents</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="modules.html"
                        title="previous chapter">server</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="server.config.html"
                        title="next chapter">server.config package</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/server.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="server.config.html" title="server.config package"
             >next</a> |</li>
        <li class="right" >
          <a href="modules.html" title="server"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Audio Tagger 1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="modules.html" >server</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Alexander Moser.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.0.1.
    </div>
  </body>
</html>